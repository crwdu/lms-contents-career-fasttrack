import { Sandpack } from "@codesandbox/sandpack-react";
import { githubLight } from "@codesandbox/sandpack-themes";
import {
  createBrowserRouter,
  RouterProvider,
} from "react-router-dom";

# React Router

## 사용 목적

Browser 환경에서 우리는 `window.location` 혹은 `window.history` 를 이용하여 페이지 전환이나 페이지 방문 기록 등을 제어할 수 있습니다. 하지만 리액트 작업 환경에서 더욱 손쉽게 페이지 전환 작업을 할 수 있게 하기 위해 `window.location` 이나 `window.history` 등의 기능을 리액트 컴포넌트화하여 우리에게 제공하는 역할을 React Router가 하고 있습니다.

그렇기에 리액트와 가장 궁합이 잘 맞는 Router는 React Router입니다. React Router는 페이지 전환 관련 작업을 React Component하여 사용할 수 있도록 합니다.

일반적으로 Router란, Single Page Application 작업에서 빠질 수 없는 중추적인 부분입니다. 기본적으로 URL에 따른 페이지 변환 또는 관련 작업이 수월하도록 돕는 역할을 합니다.

<br />
<br />

## 라우팅 설정

<br />

### `<BrowserRouter />`

아래와 같이 `BrowserRouter`를 생성하고 리액트 어플리케이션의 root로 렌더링합니다.

> `BrowserRouter`란, React Router의 최상위 컴포넌트 입니다. `BrowserRouter` 하위에서만 React Router 관련 기능을 사용할 수 있습니다.

<br />

<iframe src="https://codesandbox.io/embed/elegant-sky-zdhl8v?fontsize=14&hidenavigation=1&theme=light&view=editor"
  style={{ width:"100%", height:"500px", border:0, borderRadius: "4px", overflow:"hidden"}}
  title="elegant-sky-zdhl8v"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

<br />
<br />

### `<Routes />` & `<Route />`

Route Mapping 설정을 할 수 있도록 도와주는 컴포넌트입니다. 다음과 같이 페이지 라우팅 설정을 할 수 있습니다.

> `Route` 컴포넌트는 중첩시켜 사용할 수 있습니다. if..else 조건문 혹은 for..loop 을 중첩시켜 사용하는 것과 유사하게 우리가 원하는 만큼 중첩시켜 사용할 수 있습니다. 중첩시켜 사용할 경우, 부모 라우트에 종속된 라우트로 설정됩니다.

아래 예제에서는 4가지 라우팅 설정을 하고 있습니다.

1. `/`: `Home` 컴포넌트 렌더링
2. `/profile`: `Home` 컴포넌트 & `Profile` 컴포넌트 렌더링
3. `/account`: `Home` 컴포넌트 & `Account` 컴포넌트 렌더링
4. `/abount`: `About` 컴포넌트 렌더링

<br />

<iframe src="https://codesandbox.io/embed/modern-browser-rhgzz2?fontsize=14&hidenavigation=1&theme=light&view=editor"
  style={{ width:"100%", height:"500px", border:0, borderRadius: "4px", overflow:"hidden"}}
  title="elegant-sky-zdhl8v"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

> 위 예시에서 좌측 상단 메뉴를 통해 `/src/Home.js` 파일을 확인해보세요. `Outlet`이라는 컴포넌트가 사용된 부분을 확인할 수 있습니다. 이 부분을 잘 기억해두세요.

위 예시에서는 페이지 라우팅 설정을 하기는 했지만, 해당 페이지로 이동하는 기능은 구현되지 않았습니다.

<br />
<br />

### `<Link />`

`<a />` 태그처럼 페이지를 이동할 수 있도록 도와주는 컴포넌트입니다. `<Route />` 컴포넌트의 Mapping 설정에 따라 페이지를 이동합니다.

> 리액트 라우터의 라우팅 기능을 이용하기 위해서는 반드시 `Link` 컴포넌트를 사용해야만 합니다. `<Link />` 컴포넌트는 `<a />` 태그로 변경되어 DOM에 렌더링 됩니다.

아래 예시에서 네비게이션 메뉴들을 클릭하고 화면에 어떤 내용이 표시되는지 확인해보세요.

(`Open Sandbox`를 이용하시면 페이지 url의 변화 또한 확인할 수 있습니다.)

<br />

<iframe src="https://codesandbox.io/embed/thirsty-booth-62kj47?fontsize=14&hidenavigation=1&theme=light"
  style={{ width:"100%", height:"500px", border:0, borderRadius: "4px", overflow:"hidden"}}
  title="elegant-sky-zdhl8v"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

잘 확인해보셨나요?

이해하기 어려운 부분은 아마 없으셨겠지만, `/profile`과 `/account` 페이지에서는 조금 특별한 기능이 사용되고 있습니다.

현재 라우팅 설정(`<Route>`)를 확인해보면, `<Profile />`과 `<Account />`는 `<Home />` 컴포넌트의 하위 라우팅으로 설정되어 있습니다. 하위 라우팅을 화면에 렌더링하기 위해서는 부모 라우팅 설정(현재, `<Home />`)에서 `<Outlet />` 컴포넌트를 이용하여 하위 라우팅 컴포넌트가 렌더링 될 위치를 지정해주어야 합니다.

즉, 현재 `<Profile />`과 `<Account />`는 `<Home />` 컴포넌트 내에서 `<Outlet />` 컴포넌트가 선언된 위치에 렌더링되는 것입니다. `<Outlet />` 컴포넌트는 미래에 보여질 하위 라우팅 컴포넌트의 위치를 미리 지정하는 역할을 합니다.

<br />
<br />

## URL 파라미터

Route 설정에서 `:`을 이용하여 동적으로 변경되는 Route Parameter에 대한 설정 또한 할 수 있습니다. Route Parameter 값은 `useParams` Hook을 이용하여 접근 가능합니다.

<br />

<iframe src="https://codesandbox.io/embed/react-router-parameters-forked-v8jk8r?fontsize=14&hidenavigation=1&theme=light&view=editor"
  style={{ width:"100%", height:"500px", border:0, borderRadius: "4px", overflow:"hidden"}}
  title="elegant-sky-zdhl8v"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>

(`Open Sandbox`에서 확인하시면 더 크게 볼 수 있습니다.)

위 예시에서 보면,

1. `<Nested />` 내부에서 `children/A`, `children/B`, `children/C`라는 링크 버튼을 렌더링하고 있습니다.
2. 해당 링크 버튼을 클릭할 경우, `<App />` 내부에 선언된 `children/:childTitle` 라우팅이 동작하고, `<Child />` 컴포넌트가 렌더링 됩니다.
3. `<Child />` 컴포넌트 내부 로직이 실행되며, `useParams` 훅이 실행됩니다.
4. `useParams` 훅은 현재 URL 파라미터 정보를 객체화하여 반환합니다. ex) `{ childTitle: "something" }`
5. `<Child />` 컴포넌트는 파라미터 정보를 이용하여 화면을 렌더링합니다.

<br />
<br />

### 📘 공식문서

리액트 라우터 공식문서의 좌측 메뉴에서 `Components` 섹션에 보시면 여러 가지 컴포넌트가 제공되고 있습니다. 그리고 다양한 훅들이 제공됩니다.

지금 이 섹션에서 우리가 논의한 주제들이 가장 흔하게 많이 사용되는 컴포넌트들입니다. 그 외의 컴포넌트들도 종종 사용될 경우가 발생하긴 하지만, 난이도 자체가 매우 낮은 편입니다. 그렇기에 채용 과정에서 크게 언급되지 않는 편이기도 하니 기본적인 기능들을 잘 활용해보도록 하세요.

- [리액트 라우터 문서](https://reactrouter.com/en/main)
- 그 외에 살펴볼 만한 기능들: [`useLocation`](https://reactrouter.com/en/main/hooks/use-location), [`useNavigate`](https://reactrouter.com/en/main/hooks/use-navigate) 등
